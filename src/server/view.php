<?phpuse rpi\core\Pages;use rpi\core\services\Services;require 'mod.inc.php';/**************************************************************** * Default ****************************************************************/if (empty($page)) $page = 'index';$js[] = BASEURL .'/assets/j/extensions.js';/**************************************************************** * Statics ****************************************************************//** * Check if this view exists */$view = MOD_DIR. '/'. $module .'/views/'. $page . '.php';if (!is_file($view))    exit('Vue inexistante');/** * Load view's statics */$j = MOD_DIR. '/'. $module .'/assets/j/'. $page . '.js';if (is_file($j))    $js[] = str_replace(ROOT, BASEURL, $j);$c = MOD_DIR. '/'. $module .'/assets/c/'. $page . '.css';$css = [];if (is_file($c))    $css[] = str_replace(ROOT, BASEURL, $c);/** * Favicon */$favicon = MOD_PATH .'/'. $module .'/assets/i/favicon.png';if (!is_file(ROOT.'/'. $favicon))    $favicon = 'assets/i/favicon.png';$favicon = BASEURL.'/'.$favicon;/**************************************************************** * Notices ****************************************************************/$notices = array();if (isset($_SESSION['_notices'])) {    $notices = $_SESSION['_notices'];    unset($_SESSION['_notices']);}/**************************************************************** * Module Engine ****************************************************************/$loader = new Twig_Loader_Filesystem([ROOT.'/templates', MOD_DIR.'/'.$module.'/templates']);$twig = new Twig_Environment($loader, array(    'cache' => ROOT.'/cache/twig',    'debug' => true));/**************************************************************** * Rendering ****************************************************************//** * Load controller */$render = array();require $view;if (isset($engine) && $engine === false) {	//echo file_get_contents(MOD_DIR.'/'.$module.'/templates/'.$page.'html')	exit;}/** * Vars */$render = array_merge([            'model' => Pages::g($page),            'pages' => Pages::i(),            'services' => Services::i(),            'config' => $config        ], $render    );/** * Customs */$twig->addFunction(new Twig_SimpleFunction('debug', 'd'));$twig->addFunction(new Twig_SimpleFunction('is_object', 'is_object'));$twig->addFunction(new Twig_SimpleFunction('microtime', 'microtime'));$twig->addFunction(new Twig_SimpleFunction('base64_encode', 'base64_encode'));$twig->addFilter(new Twig_SimpleFilter('printsize', 'printsize'));$twig->addGlobal('app', [        'get' => $_GET,        'post' => $_POST,        'request' => $_REQUEST,        'session' => @$_SESSION ? : [],        'server' => $_SERVER,        'notices' => $notices    ]);/** * Display */echo $twig->loadTemplate('global/header.html')->render(['favicon' => $favicon, 'css' => $css, 'js' => $js]);echo $twig->loadTemplate($page .'.html')->render($render);echo $twig->loadTemplate('global/footer.html')->render([]);